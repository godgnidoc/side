<h1>Side 项目框架使用说明</h1>

Side $_{(Smooth\ Integrated\ Development\ Environment)}$ 平滑集成开发环境，side 被设计用于提供简单的开发环境搭建体验以及平滑的开发环境切换体验。

Side 工具主要面向两类用户：环境搭建人员和应用开发人员。本文档将全面阐述 side 工具的使用方法，用户可以根据自身情况选取片段查阅。

# 0. 目录

- [0. 目录](#0-目录)
- [1. 快速开始](#1-快速开始)
  - [1.1. 安装 side](#11-安装-side)
  - [1.1. 当前项目状态](#11-当前项目状态)
  - [1.3. 搭建环境](#13-搭建环境)
  - [1.4. 编译构建](#14-编译构建)
  - [1.5. 打包](#15-打包)
  - [1.6. 获得帮助](#16-获得帮助)
- [2. side 工具简介](#2-side-工具简介)
  - [2.1. 项目开发流程](#21-项目开发流程)
  - [2.2. 资源分发管理](#22-资源分发管理)
- [3. 搭建项目](#3-搭建项目)
  - [3.1. 清单与目标](#31-清单与目标)
  - [3.2. 切面与继承](#32-切面与继承)
  - [3.3. 打包与分发](#33-打包与分发)
  - [3.4. 环境变量](#34-环境变量)
- [4. 参考](#4-参考)
  - [4.1. 设置参考](#41-设置参考)
  - [4.2. 变量参考](#42-变量参考)
  - [4.3. 路径参考](#43-路径参考)

# 1. 快速开始

## 1.1. 安装 side

从0安装side需要两个步骤：

1. 设置分发服务器地址，安装side的步骤以及安装后的side将与此服务器沟通
    
    ```bash
    #!/bin/bash

    export HOST=IP:PORT
    ```
    
2. 获取并执行自动安装脚本

    ```bash
    #!/bin/bash

    curl -s http://${HOST}/api/dl?p=install.sh | bash
    ```

若安装成功，终端将打印如下字样：

```
Side installed successfully, please restart your terminal.
Enjoy!
```

side 工具安装后立即可以使用，但自动命令行提示符需要重启终端才能显示。

## 1.1. 当前项目状态

side 向 `~/.bashrc` 注入了一些环境修改语句，这使得 side 可以在 bash 即将打印命令行提示符之前检查当前项目的状态并附加文本描述。

若当前路径不在 side 项目中，则不显示任何额外的提示文本。

项目状态信息的格式：` 项目名 : 当前目标 : 项目状态 `

## 1.3. 搭建环境

在 side 项目路径下任意位置执行如下指令即可面向指定的**目标**搭建环境：

```bash
#!/bin/bash

side setup 目标名
```

选定**目标**意味着选择了编译项目使用的SDK、开放或关闭的功能集合以及其它编译发布前可以选择的设定项。

目标的详细情况被记录于目标配置文件，由环境搭建人员负责编写。Side 会根据目标信息自动获取项目依赖的工具、库或源码子仓库，并执行环境搭建人员指定的钩子脚本。

若环境搭建成功，项目状态将被改写为 `ready`

## 1.4. 编译构建

当项目处于 `ready` 状态时，可以执行如下指令以构建项目：

```bash
#!/bin/bash

side build ...
```

build 指令可以携带参数，具体语义由环境搭建人员指定的钩子脚本决定。

若编译流程顺利结束，且 build 指令没有携带参数，则项目状态将被改写为 `built`

## 1.5. 打包

当项目处于 `built` 状态时，可以执行如下指令以打包项目编译产物：

```bash
#!/bin/bash

side package
```

package 指令会执行环境搭建人员指定的钩子脚本，若打包成功，则项目状态被改写为 `packed`

## 1.6. 获得帮助

指令 `side help` 可以展示 side 工具的帮助页面。`help` 指令可以携带参数，展示更详细的功能或选项介绍。

# 2. side 工具简介

Side 工具是一组由 NodeJS 驱动的 JavaScript 脚本，提供的功能主要分为**项目开发流程**和**资源分发管理**两个方面。

## 2.1. 项目开发流程

Side 为项目定义了状态和用于改变项目状态的指令，以此构建了项目开发流程的规范化模型。

Side 项目总是从**起草**状态开始，顺次经历**就绪**、**已构建**和**已打包**状态。Side 项目不能跳过中间状态，但是可以从任何状态回到**起草**状态。用户可以编写特定的脚本，Side 会在状态转换过程中调用它们，这些脚本被成为钩子脚本。

Side 为项目开发引入了**目标**概念，用于确定项目开发环境和目标产物的可设定细节。通过目标确定的大部分设定都可以以环境变量的形式在钩子脚本被引用。

## 2.2. 资源分发管理

> 大部分情况下应用开发人员不需要直接接触 dist 工具，如果您对此部分内容不感兴趣，可以跳过。

Side 工具包提供了 dist 和 dist-server 用于处理与资源分发相关的事务。dist 工具可以用于打包、发布以及安装资源分发包。dist-server 则被用于实现一个持久化的资源托管分发服务器。

dist 定义了一种包结构以及它的状态和状态间的转换指令。dist 包可以使用 dist 工具创建，也可以手工打造。dist 包可以被发布到 dist-server 上托管，可以被获取、解包、安装、卸载。

除此之外 dist 包还可以在某个具体的项目中被测试、激活和灭活。Side 依赖这些细分的资源状态令多个互斥的资源可以同时被安装在一台机器上，但仅在局部环境激活，以避免冲突。

# 3. 搭建项目

## 3.1. 清单与目标

## 3.2. 切面与继承

## 3.3. 打包与分发

## 3.4. 环境变量

# 4. 参考

## 4.1. 设置参考

## 4.2. 变量参考

## 4.3. 路径参考